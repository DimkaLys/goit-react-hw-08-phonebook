(this["webpackJsonpgoit-react-hw-08-phonebook"]=this["webpackJsonpgoit-react-hw-08-phonebook"]||[]).push([[0],{10:function(e,t,n){"use strict";n.d(t,"d",(function(){return j})),n.d(t,"b",(function(){return b})),n.d(t,"c",(function(){return f})),n.d(t,"a",(function(){return h}));var r=n(16),c=n.n(r),a=n(24),u=n(18),i=n.n(u),o=n(2),s=n(19);i.a.defaults.baseURL="https://connections-api.herokuapp.com/";var l=function(e){i.a.defaults.headers.common.Authorization="Bearer ".concat(e)},d=function(){i.a.defaults.headers.common.Authorization=""},j=Object(o.c)("users/signup",function(){var e=Object(a.a)(c.a.mark((function e(t,n){var r,a,u;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.rejectWithValue,e.prev=1,e.next=4,i.a.post("users/signup",t);case 4:return a=e.sent,u=a.data,l(u.token),s.b.success("You have successfully registered"),e.abrupt("return",u);case 11:return e.prev=11,e.t0=e.catch(1),e.abrupt("return",r(s.b.error("There is an error: ".concat(e.t0))));case 14:case"end":return e.stop()}}),e,null,[[1,11]])})));return function(t,n){return e.apply(this,arguments)}}()),b=Object(o.c)("users/login",function(){var e=Object(a.a)(c.a.mark((function e(t,n){var r,a,u;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.rejectWithValue,e.prev=1,e.next=4,i.a.post("users/login",t);case 4:return a=e.sent,u=a.data,l(u.token),s.b.success("You have successfully logged in"),e.abrupt("return",u);case 11:return e.prev=11,e.t0=e.catch(1),e.abrupt("return",r(s.b.error("There is an error: ".concat(e.t0))));case 14:case"end":return e.stop()}}),e,null,[[1,11]])})));return function(t,n){return e.apply(this,arguments)}}()),f=Object(o.c)("users/logout",function(){var e=Object(a.a)(c.a.mark((function e(t,n){var r;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.rejectWithValue,e.prev=1,e.next=4,i.a.post("users/logout");case 4:d(),e.next=10;break;case 7:return e.prev=7,e.t0=e.catch(1),e.abrupt("return",r(e.t0));case 10:case"end":return e.stop()}}),e,null,[[1,7]])})));return function(t,n){return e.apply(this,arguments)}}()),h=Object(o.c)("users/current",function(){var e=Object(a.a)(c.a.mark((function e(t,n){var r,a,u,o,s,d;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=n.getState,a=n.rejectWithValue,u=r(),null!==(o=u.auth.token)){e.next=5;break}return e.abrupt("return",a());case 5:return l(o),e.prev=6,e.next=9,i.a.get("users/current");case 9:return s=e.sent,d=s.data,console.log(d),e.abrupt("return",d);case 15:return e.prev=15,e.t0=e.catch(6),console.log("error in GetCurrentUser: ",e.t0),e.abrupt("return",a(e.t0));case 19:case"end":return e.stop()}}),e,null,[[6,15]])})));return function(t,n){return e.apply(this,arguments)}}())},107:function(e,t,n){"use strict";n.r(t);var r={};n.r(r),n.d(r,"getAuth",(function(){return p})),n.d(r,"getUser",(function(){return O})),n.d(r,"getIsFetchingCurrent",(function(){return g}));var c,a=n(0),u=n.n(a),i=n(21),o=n.n(i),s=n(4),l=(n(63),n(64),n(65),n(66),n(19)),d=n(3),j=n(7),b=n(2),f=n(10),h=Object(b.d)({name:"auth",initialState:{user:{name:null,email:null},token:null,isAuth:!1,isLoading:!1,error:null,isFetchingCurrent:!1},extraReducers:(c={},Object(j.a)(c,f.d.pending,(function(e){e.isLoading=!0,e.error=null})),Object(j.a)(c,f.d.fulfilled,(function(e,t){e.user=t.payload.user,e.token=t.payload.token,e.isLoading=!1,e.isAuth=!0})),Object(j.a)(c,f.d.rejected,(function(e,t){e.isLoading=!1,e.error=t.error.message})),Object(j.a)(c,f.b.pending,(function(e){e.isLoading=!0,e.error=null})),Object(j.a)(c,f.b.fulfilled,(function(e,t){e.user=t.payload.user,e.token=t.payload.token,e.isLoading=!1,e.isAuth=!0})),Object(j.a)(c,f.b.rejected,(function(e,t){e.isLoading=!1,e.error=t.error.message})),Object(j.a)(c,f.a.pending,(function(e){e.isFetchingCurrent=!0,e.isLoading=!0,e.error=null})),Object(j.a)(c,f.a.fulfilled,(function(e,t){e.user=t.payload,e.isAuth=!0,e.isLoading=!1,e.isFetchingCurrent=!1})),Object(j.a)(c,f.a.rejected,(function(e,t){e.isFetchingCurrent=!1,e.isLoading=!1,e.error=t.error.message})),Object(j.a)(c,f.c.pending,(function(e){e.isLoading=!0,e.error=null})),Object(j.a)(c,f.c.fulfilled,(function(e){e.user={name:null,email:null},e.token=null,e.isLoading=!1,e.isAuth=!1})),Object(j.a)(c,f.c.rejected,(function(e,t){e.isLoading=!1,e.error=t.error.message})),c)}).reducer,p=function(e){return e.auth.isAuth},O=function(e){return e.auth.user.name},g=function(e){return e.auth.isFetchingCurrent},v=n(1);function x(e){var t=e.component,n=Object(s.e)(r.getAuth);return Object(v.jsx)(v.Fragment,{children:n?Object(v.jsx)(t,{}):Object(v.jsx)(d.a,{to:"/login"})})}function m(e){var t=e.redirectedTo,n=void 0===t?"/":t,c=e.restricted,a=void 0!==c&&c,u=e.component,i=Object(s.e)(r.getAuth)&&a;return Object(v.jsx)(v.Fragment,{children:i?Object(v.jsx)(d.a,{to:n}):Object(v.jsx)(u,{})})}var k=n(45),_=n.n(k),y=n(28),C=n.n(y),L=n(15),A=function(e){return e.isActive?C.a.activeLink:C.a.link},N=function(){var e=Object(s.e)(r.getAuth);return Object(v.jsxs)("nav",{className:C.a.nav,children:[Object(v.jsx)(L.b,{to:"/",exact:"true",className:A,children:"Home Page"}),e&&Object(v.jsx)(L.b,{to:"/contacts",exact:"true",className:A,children:"Contacts"})]})},w=n(29),T=n.n(w);function F(){var e=Object(s.d)(),t=Object(s.e)(r.getUser);return Object(v.jsxs)("div",{className:T.a.container,children:[Object(v.jsxs)("span",{className:T.a.name,children:["Welcome, ",t]}),Object(v.jsx)("button",{type:"button",className:T.a.button,onClick:function(){return e(Object(f.c)())},children:"Logout"})]})}var z=n(30),S=n.n(z),P=function(e){return e.isActive?S.a.activeLink:S.a.link};function U(){return Object(v.jsxs)("div",{className:S.a.container,children:[Object(v.jsx)(L.b,{to:"/register",exact:"true",className:P,children:"Register"}),Object(v.jsx)(L.b,{to:"/login",exact:"true",className:P,children:"Login"})]})}function q(){var e=Object(s.e)(r.getAuth);return Object(v.jsxs)("header",{className:_.a.header,children:[Object(v.jsx)(N,{}),e?Object(v.jsx)(F,{}):Object(v.jsx)(U,{})]})}var E=n(46),W=n.n(E);function B(e){var t=e.children;return Object(v.jsx)("div",{className:W.a.container,children:t})}var M=n(32),V=Object(a.lazy)((function(){return n.e(6).then(n.bind(null,110))})),D=Object(a.lazy)((function(){return n.e(3).then(n.bind(null,115))})),I=Object(a.lazy)((function(){return n.e(4).then(n.bind(null,111))})),Q=Object(a.lazy)((function(){return n.e(5).then(n.bind(null,112))})),R=Object(a.lazy)((function(){return n.e(7).then(n.bind(null,113))}));function Y(){var e=Object(s.d)(),t=Object(s.e)(r.getIsFetchingCurrent);return Object(a.useEffect)((function(){e(Object(f.a)())}),[e]),Object(v.jsx)(B,{children:t?Object(v.jsx)(M.a,{}):Object(v.jsxs)(v.Fragment,{children:[Object(v.jsx)(q,{}),Object(v.jsx)(l.a,{theme:"colored",autoClose:2e3}),Object(v.jsx)(a.Suspense,{fallback:Object(v.jsx)(M.a,{}),children:Object(v.jsxs)(d.d,{children:[Object(v.jsx)(d.b,{path:"/",exact:"true",element:Object(v.jsx)(m,{component:V})}),Object(v.jsx)(d.b,{path:"/contacts",exact:"true",element:Object(v.jsx)(x,{component:D})}),Object(v.jsx)(d.b,{path:"/login",exact:"true",element:Object(v.jsx)(m,{restricted:!0,redirectedTo:"/contacts",component:I})}),Object(v.jsx)(d.b,{path:"/register",exact:"true",element:Object(v.jsx)(m,{restricted:!0,component:Q})}),Object(v.jsx)(d.b,{path:"*",element:Object(v.jsx)(R,{})})]})})]})})}var G,H=function(e){e&&e instanceof Function&&n.e(8).then(n.bind(null,114)).then((function(t){var n=t.getCLS,r=t.getFID,c=t.getFCP,a=t.getLCP,u=t.getTTFB;n(e),r(e),c(e),a(e),u(e)}))},J=n(9),Z=n(17),K=n(49),X=n.n(K),$=n(27),ee=n(43),te={key:"auth",storage:X.a,whitelist:["token"]},ne=Object(Z.g)(te,h),re=Object(b.a)({reducer:(G={},Object(j.a)(G,$.a.reducerPath,$.a.reducer),Object(j.a)(G,"filter",ee.a),Object(j.a)(G,"auth",ne),G),middleware:function(e){return e({serializableCheck:{ignoredActions:[Z.a,Z.f,Z.b,Z.c,Z.d,Z.e]}}).concat($.a.middleware)},devTools:!1});Object(J.e)(re.dispatch);var ce=Object(Z.h)(re),ae=n(52);o.a.render(Object(v.jsx)(u.a.StrictMode,{children:Object(v.jsx)(s.a,{store:re,children:Object(v.jsx)(ae.a,{loading:"Loading Persist...",persistor:ce,children:Object(v.jsx)(L.a,{children:Object(v.jsx)(Y,{})})})})}),document.getElementById("root")),H()},27:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"d",(function(){return o})),n.d(t,"b",(function(){return s})),n.d(t,"c",(function(){return l}));var r=n(50),c=n(53),a=n(51),u=n(9),i=Object(a.a)({reducerPath:"contacts",tagTypes:["Contacts"],baseQuery:Object(u.d)({baseUrl:"https://61ad23ced228a9001703ad12.mockapi.io"}),endpoints:function(e){return{getContacts:e.query({query:function(){return"/contacts"},providesTags:function(e){return e?[].concat(Object(c.a)(e.map((function(e){return{type:"Contacts",id:e.id}}))),[{type:"Contacts"}]):["Contacts"]}}),addContact:e.mutation({query:function(e){return{url:"/contacts",method:"POST",body:Object(r.a)({},e)}},invalidatesTags:["Contacts"]}),deleteContact:e.mutation({query:function(e){return{url:"/contacts/".concat(e),method:"DELETE"}},invalidatesTags:["Contacts"]})}}}),o=i.useGetContactsQuery,s=i.useAddContactMutation,l=i.useDeleteContactMutation},28:function(e,t,n){e.exports={nav:"Navigation_nav__3e6dY",link:"Navigation_link__3qs5o",activeLink:"Navigation_activeLink__1mElr"}},29:function(e,t,n){e.exports={container:"UserMenu_container__3g-2l",button:"UserMenu_button__9QWF5"}},30:function(e,t,n){e.exports={container:"AuthNav_container__2Bd6Z",link:"AuthNav_link__2Szq9",activeLink:"AuthNav_activeLink__18cpS"}},32:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(47),c=n.n(r),a=n(48),u=n.n(a),i=(n(104),n(1));function o(){return Object(i.jsx)("div",{className:c.a.loader,children:Object(i.jsx)(u.a,{type:"ThreeDots",color:"#3f51b5",height:80,width:80,timeout:3e3})})}},43:function(e,t,n){"use strict";n.d(t,"b",(function(){return a}));var r=n(2),c=Object(r.d)({name:"filter",initialState:{filter:""},reducers:{filterContact:function(e,t){e.filter=t.payload}}}),a=c.actions.filterContact;t.a=c.reducer},45:function(e,t,n){e.exports={header:"AppBar_header__2mTpC"}},46:function(e,t,n){e.exports={container:"Container_container__3Teff"}},47:function(e,t,n){e.exports={loader:"Loader_loader__QVRpH"}},64:function(e,t,n){},65:function(e,t,n){}},[[107,1,2]]]);
//# sourceMappingURL=main.50d318fe.chunk.js.map